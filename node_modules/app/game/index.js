var weaponsModule = require('app/weapons'),
    playersModule = require('app/players'),
    countriesScore = {};

module.exports = {
    tryGetGameInfo: function(playerName, playerKey) {
        var player = playersModule.playersHash[playerName];
        return {
            playerData: player && player.key === playerKey ? player : null,
            playersHash: playersModule.playersHash
        }
    },

    shot: function(playerName, key, targetPlayerName, selectedWeaponName) {
        var player = playersModule.playersHash[playerName],
            targetPlayer = playersModule.playersHash[targetPlayerName];
        if(!player || !targetPlayer || player.key !== key) {
            return false;
        }
        var shotResult = player.shot(targetPlayer, selectedWeaponName);
        if(shotResult.isKill) {
            countriesScore[player.country.demonym] = (countriesScore[player.country.demonym] || 0) + 1;
        }
        return shotResult;
    }
};

